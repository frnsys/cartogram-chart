!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(n.d3=n.d3||{})}(this,function(n){"use strict";function t(n,t){return n<t?-1:n>t?1:n>=t?0:NaN}function r(n){return function(r,i){return t(n(r),i)}}function i(n){for(var t,r,i,e=n.length,o=-1,u=0;++o<e;)u+=n[o].length;for(r=new Array(u);--e>=0;)for(i=n[e],t=i.length;--t>=0;)r[--u]=i[t];return r}function e(n,t){var r,i=n.length,e=-1,o=0;if(null==t)for(;++e<i;)(r=+n[e])&&(o+=r);else for(;++e<i;)(r=+t(n[e],e,n))&&(o+=r);return o}function o(){return new u}function u(){this.reset()}function a(n,t,r){var i=n.s=t+r,e=i-t,o=i-e;n.t=t-o+(r-e)}function f(n){return n>1?0:n<-1?Qn:Math.acos(n)}function c(n){return n>1?Un:n<-1?-Un:Math.asin(n)}function l(){}function s(n,t){n&&ft.hasOwnProperty(n.type)&&ft[n.type](n,t)}function p(n,t,r){var i,e=-1,o=n.length-r;for(t.lineStart();++e<o;)i=n[e],t.point(i[0],i[1],i[2]);t.lineEnd()}function h(n,t){var r=-1,i=n.length;for(t.polygonStart();++r<i;)p(n[r],t,1);t.polygonEnd()}function v(n,t){n&&at.hasOwnProperty(n.type)?at[n.type](n,t):s(n,t)}function g(n){return[rt(n[1],n[0]),c(n[2])]}function d(n){var t=n[0],r=n[1],i=it(r);return[i*it(t),i*et(t),et(r)]}function y(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function m(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function S(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function E(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function _(n){var t=ut(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function M(n,t){return(t-=n)<0?t+360:t}function x(n,t){function r(r,i){return r=n(r,i),t(r[0],r[1])}return n.invert&&t.invert&&(r.invert=function(r,i){return(r=t.invert(r,i))&&n.invert(r[0],r[1])}),r}function b(n,t){return[n>Qn?n-Xn:n<-Qn?n+Xn:n,t]}function w(n,t,r){return(n%=Xn)?t||r?x(P(n),j(t,r)):P(n):t||r?j(t,r):b}function N(n){return function(t,r){return t+=n,[t>Qn?t-Xn:t<-Qn?t+Xn:t,r]}}function P(n){var t=N(n);return t.invert=N(-n),t}function j(n,t){function r(n,t){var r=it(t),a=it(n)*r,f=et(n)*r,l=et(t),s=l*i+a*e;return[rt(f*o-s*u,a*i-l*e),c(s*o+f*u)]}var i=it(n),e=et(n),o=it(t),u=et(t);return r.invert=function(n,t){var r=it(t),a=it(n)*r,f=et(n)*r,l=et(t),s=l*o-f*u;return[rt(f*o+l*u,a*i+s*e),c(s*i-a*e)]},r}function k(n,t,r,i,e,o){if(r){var u=it(t),a=et(t),f=i*r;null==e?(e=t+i*Xn,o=t-f/2):(e=A(u,e),o=A(u,o),(i>0?e<o:e>o)&&(e+=i*Xn));for(var c,l=e;i>0?l>o:l<o;l-=f)c=g([u,-a*it(l),-a*et(l)]),n.point(c[0],c[1])}}function A(n,t){t=d(t),t[0]-=n,_(t);var r=f(-t[1]);return((-t[2]<0?-r:r)+Xn-Kn)%Xn}function F(){var n,t=[];return{point:function(t,r){n.push([t,r])},lineStart:function(){t.push(n=[])},lineEnd:l,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var r=t;return t=[],n=null,r}}}function q(n,t){return nt(n[0]-t[0])<Kn&&nt(n[1]-t[1])<Kn}function O(n,t,r,i){this.x=n,this.z=t,this.o=r,this.e=i,this.v=!1,this.n=this.p=null}function z(n,t,r,i,e){var o,u,a=[],f=[];if(n.forEach(function(n){if(!((t=n.length-1)<=0)){var t,r,i=n[0],u=n[t];if(q(i,u)){for(e.lineStart(),o=0;o<t;++o)e.point((i=n[o])[0],i[1]);return void e.lineEnd()}a.push(r=new O(i,n,null,!0)),f.push(r.o=new O(i,null,r,!1)),a.push(r=new O(u,n,null,!1)),f.push(r.o=new O(u,null,r,!0))}}),a.length){for(f.sort(t),C(a),C(f),o=0,u=f.length;o<u;++o)f[o].e=r=!r;for(var c,l,s=a[0];;){for(var p=s,h=!0;p.v;)if((p=p.n)===s)return;c=p.z,e.lineStart();do{if(p.v=p.o.v=!0,p.e){if(h)for(o=0,u=c.length;o<u;++o)e.point((l=c[o])[0],l[1]);else i(p.x,p.n.x,1,e);p=p.n}else{if(h)for(c=p.p.z,o=c.length-1;o>=0;--o)e.point((l=c[o])[0],l[1]);else i(p.x,p.p.x,-1,e);p=p.p}p=p.o,c=p.z,h=!h}while(!p.v);e.lineEnd()}}}function C(n){if(t=n.length){for(var t,r,i=0,e=n[0];++i<t;)e.n=r=n[i],r.p=e,e=r;e.n=r=n[0],r.p=e}}function L(n,t){var r=t[0],i=t[1],e=[et(r),-it(r),0],o=0,u=0;yt.reset();for(var a=0,f=n.length;a<f;++a)if(s=(l=n[a]).length)for(var l,s,p=l[s-1],h=p[0],v=p[1]/2+Vn,g=et(v),y=it(v),S=0;S<s;++S,h=M,g=b,y=w,p=E){var E=l[S],M=E[0],x=E[1]/2+Vn,b=et(x),w=it(x),N=M-h,P=N>=0?1:-1,j=P*N,k=j>Qn,A=g*b;if(yt.add(rt(A*P*et(j),y*w+A*it(j))),o+=k?N+P*Xn:N,k^h>=r^M>=r){var F=m(d(p),d(E));_(F);var q=m(e,F);_(q);var O=(k^N>=0?-1:1)*c(q[2]);(i>O||i===O&&(F[0]||F[1]))&&(u+=k^N>=0?1:-1)}}return(o<-Kn||o<Kn&&yt<-Kn)^1&u}function R(n,t,r,e){return function(o){function u(t,r){n(t,r)&&o.point(t,r)}function a(n,t){d.point(n,t)}function f(){E.point=a,d.lineStart()}function c(){E.point=u,d.lineEnd()}function l(n,t){g.push([n,t]),m.point(n,t)}function s(){m.lineStart(),g=[]}function p(){l(g[0][0],g[0][1]),m.lineEnd();var n,t,r,i,e=m.clean(),u=y.result(),a=u.length;if(g.pop(),h.push(g),g=null,a)if(1&e){if(r=u[0],(t=r.length-1)>0){for(S||(o.polygonStart(),S=!0),o.lineStart(),n=0;n<t;++n)o.point((i=r[n])[0],i[1]);o.lineEnd()}}else a>1&&2&e&&u.push(u.pop().concat(u.shift())),v.push(u.filter(G))}var h,v,g,d=t(o),y=F(),m=t(y),S=!1,E={point:u,lineStart:f,lineEnd:c,polygonStart:function(){E.point=l,E.lineStart=s,E.lineEnd=p,v=[],h=[]},polygonEnd:function(){E.point=u,E.lineStart=f,E.lineEnd=c,v=i(v);var n=L(h,e);v.length?(S||(o.polygonStart(),S=!0),z(v,T,n,r,o)):n&&(S||(o.polygonStart(),S=!0),o.lineStart(),r(null,null,1,o),o.lineEnd()),S&&(o.polygonEnd(),S=!1),v=h=null},sphere:function(){o.polygonStart(),o.lineStart(),r(null,null,1,o),o.lineEnd(),o.polygonEnd()}};return E}}function G(n){return n.length>1}function T(n,t){return((n=n.x)[0]<0?n[1]-Un-Kn:Un-n[1])-((t=t.x)[0]<0?t[1]-Un-Kn:Un-t[1])}function D(n){var t,r=NaN,i=NaN,e=NaN;return{lineStart:function(){n.lineStart(),t=1},point:function(o,u){var a=o>0?Qn:-Qn,f=nt(o-r);nt(f-Qn)<Kn?(n.point(r,i=(i+u)/2>0?Un:-Un),n.point(e,i),n.lineEnd(),n.lineStart(),n.point(a,i),n.point(o,i),t=0):e!==a&&f>=Qn&&(nt(r-e)<Kn&&(r-=e*Kn),nt(o-a)<Kn&&(o-=a*Kn),i=I(r,i,o,u),n.point(e,i),n.lineEnd(),n.lineStart(),n.point(a,i),t=0),n.point(r=o,i=u),e=a},lineEnd:function(){n.lineEnd(),r=i=NaN},clean:function(){return 2-t}}}function I(n,t,r,i){var e,o,u=et(n-r);return nt(u)>Kn?tt((et(t)*(o=it(i))*et(r)-et(i)*(e=it(t))*et(n))/(e*o*u)):(t+i)/2}function H(n,t,r,i){var e;if(null==n)e=r*Un,i.point(-Qn,e),i.point(0,e),i.point(Qn,e),i.point(Qn,0),i.point(Qn,-e),i.point(0,-e),i.point(-Qn,-e),i.point(-Qn,0),i.point(-Qn,e);else if(nt(n[0]-t[0])>Kn){var o=n[0]<t[0]?Qn:-Qn;e=r*o/2,i.point(-o,e),i.point(0,e),i.point(o,e)}else i.point(t[0],t[1])}function W(n){function t(t,r,i,e){k(e,n,a,i,t,r)}function r(n,t){return it(n)*it(t)>u}function i(n){var t,i,u,a,l;return{lineStart:function(){a=u=!1,l=1},point:function(s,p){var h,v=[s,p],g=r(s,p),d=f?g?0:o(s,p):g?o(s+(s<0?Qn:-Qn),p):0;if(!t&&(a=u=g)&&n.lineStart(),g!==u&&(!(h=e(t,v))||q(t,h)||q(v,h))&&(v[0]+=Kn,v[1]+=Kn,g=r(v[0],v[1])),g!==u)l=0,g?(n.lineStart(),h=e(v,t),n.point(h[0],h[1])):(h=e(t,v),n.point(h[0],h[1]),n.lineEnd()),t=h;else if(c&&t&&f^g){var y;d&i||!(y=e(v,t,!0))||(l=0,f?(n.lineStart(),n.point(y[0][0],y[0][1]),n.point(y[1][0],y[1][1]),n.lineEnd()):(n.point(y[1][0],y[1][1]),n.lineEnd(),n.lineStart(),n.point(y[0][0],y[0][1])))}!g||t&&q(t,v)||n.point(v[0],v[1]),t=v,u=g,i=d},lineEnd:function(){u&&n.lineEnd(),t=null},clean:function(){return l|(a&&u)<<1}}}function e(n,t,r){var i=d(n),e=d(t),o=[1,0,0],a=m(i,e),f=y(a,a),c=a[0],l=f-c*c;if(!l)return!r&&n;var s=u*f/l,p=-u*c/l,h=m(o,a),v=E(o,s);S(v,E(a,p));var _=h,M=y(v,_),x=y(_,_),b=M*M-x*(y(v,v)-1);if(!(b<0)){var w=ut(b),N=E(_,(-M-w)/x);if(S(N,v),N=g(N),!r)return N;var P,j=n[0],k=t[0],A=n[1],F=t[1];k<j&&(P=j,j=k,k=P);var q=k-j,O=nt(q-Qn)<Kn,z=O||q<Kn;if(!O&&F<A&&(P=A,A=F,F=P),z?O?A+F>0^N[1]<(nt(N[0]-j)<Kn?A:F):A<=N[1]&&N[1]<=F:q>Qn^(j<=N[0]&&N[0]<=k)){var C=E(_,(-M+w)/x);return S(C,v),[N,g(C)]}}}function o(t,r){var i=f?n:Qn-n,e=0;return t<-i?e|=1:t>i&&(e|=2),r<-i?e|=4:r>i&&(e|=8),e}var u=it(n),a=6*$n,f=u>0,c=nt(u)>Kn;return R(r,i,t,f?[0,-n]:[-Qn,n-Qn])}function Z(n,t,r,i,e,o){var u,a=n[0],f=n[1],c=t[0],l=t[1],s=0,p=1,h=c-a,v=l-f;if(u=r-a,h||!(u>0)){if(u/=h,h<0){if(u<s)return;u<p&&(p=u)}else if(h>0){if(u>p)return;u>s&&(s=u)}if(u=e-a,h||!(u<0)){if(u/=h,h<0){if(u>p)return;u>s&&(s=u)}else if(h>0){if(u<s)return;u<p&&(p=u)}if(u=i-f,v||!(u>0)){if(u/=v,v<0){if(u<s)return;u<p&&(p=u)}else if(v>0){if(u>p)return;u>s&&(s=u)}if(u=o-f,v||!(u<0)){if(u/=v,v<0){if(u>p)return;u>s&&(s=u)}else if(v>0){if(u<s)return;u<p&&(p=u)}return s>0&&(n[0]=a+s*h,n[1]=f+s*v),p<1&&(t[0]=a+p*h,t[1]=f+p*v),!0}}}}}function B(n,t,r,e){function o(i,o){return n<=i&&i<=r&&t<=o&&o<=e}function u(i,o,u,f){var l=0,s=0;if(null==i||(l=a(i,u))!==(s=a(o,u))||c(i,o)<0^u>0)do{f.point(0===l||3===l?n:r,l>1?e:t)}while((l=(l+u+4)%4)!==s);else f.point(o[0],o[1])}function a(i,e){return nt(i[0]-n)<Kn?e>0?0:3:nt(i[0]-r)<Kn?e>0?2:1:nt(i[1]-t)<Kn?e>0?1:0:e>0?3:2}function f(n,t){return c(n.x,t.x)}function c(n,t){var r=a(n,1),i=a(t,1);return r!==i?r-i:0===r?t[1]-n[1]:1===r?n[0]-t[0]:2===r?n[1]-t[1]:t[0]-n[0]}return function(a){function c(n,t){o(n,t)&&P.point(n,t)}function l(){for(var t=0,r=0,i=y.length;r<i;++r)for(var o,u,a=y[r],f=1,c=a.length,l=a[0],s=l[0],p=l[1];f<c;++f)o=s,u=p,l=a[f],s=l[0],p=l[1],u<=e?p>e&&(s-o)*(e-u)>(p-u)*(n-o)&&++t:p<=e&&(s-o)*(e-u)<(p-u)*(n-o)&&--t;return t}function s(){P=j,d=[],y=[],N=!0}function p(){var n=l(),t=N&&n,r=(d=i(d)).length;(t||r)&&(a.polygonStart(),t&&(a.lineStart(),u(null,null,1,a),a.lineEnd()),r&&z(d,f,n,u,a),a.polygonEnd()),P=a,d=y=m=null}function h(){k.point=g,y&&y.push(m=[]),w=!0,b=!1,M=x=NaN}function v(){d&&(g(S,E),_&&b&&j.rejoin(),d.push(j.result())),k.point=c,b&&P.lineEnd()}function g(i,u){var a=o(i,u);if(y&&m.push([i,u]),w)S=i,E=u,_=a,w=!1,a&&(P.lineStart(),P.point(i,u));else if(a&&b)P.point(i,u);else{var f=[M=Math.max(Et,Math.min(St,M)),x=Math.max(Et,Math.min(St,x))],c=[i=Math.max(Et,Math.min(St,i)),u=Math.max(Et,Math.min(St,u))];Z(f,c,n,t,r,e)?(b||(P.lineStart(),P.point(f[0],f[1])),P.point(c[0],c[1]),a||P.lineEnd(),N=!1):a&&(P.lineStart(),P.point(i,u),N=!1)}M=i,x=u,b=a}var d,y,m,S,E,_,M,x,b,w,N,P=a,j=F(),k={point:c,lineStart:h,lineEnd:v,polygonStart:s,polygonEnd:p};return k}}function J(n){return n}function K(){xt.point=Q}function Q(n,t){xt.point=U,ct=st=n,lt=pt=t}function U(n,t){Mt.add(pt*n-st*t),st=n,pt=t}function V(){U(ct,lt)}function X(n,t){n<bt&&(bt=n),n>Nt&&(Nt=n),t<wt&&(wt=t),t>Pt&&(Pt=t)}function Y(n,t){kt+=n,At+=t,++Ft}function $(){Gt.point=nn}function nn(n,t){Gt.point=tn,Y(gt=n,dt=t)}function tn(n,t){var r=n-gt,i=t-dt,e=ut(r*r+i*i);qt+=e*(gt+n)/2,Ot+=e*(dt+t)/2,zt+=e,Y(gt=n,dt=t)}function rn(){Gt.point=Y}function en(){Gt.point=un}function on(){an(ht,vt)}function un(n,t){Gt.point=an,Y(ht=gt=n,vt=dt=t)}function an(n,t){var r=n-gt,i=t-dt,e=ut(r*r+i*i);qt+=e*(gt+n)/2,Ot+=e*(dt+t)/2,zt+=e,e=dt*n-gt*t,Ct+=e*(gt+n),Lt+=e*(dt+t),Rt+=3*e,Y(gt=n,dt=t)}function fn(n){this._context=n}function cn(n,t){Bt.point=ln,Dt=Ht=n,It=Wt=t}function ln(n,t){Ht-=n,Wt-=t,Zt.add(ut(Ht*Ht+Wt*Wt)),Ht=n,Wt=t}function sn(){this._string=[]}function pn(n){return"m0,"+n+"a"+n+","+n+" 0 1,1 0,"+-2*n+"a"+n+","+n+" 0 1,1 0,"+2*n+"z"}function hn(n,t){function r(n){return n&&("function"==typeof o&&e.pointRadius(+o.apply(this,arguments)),v(n,i(e))),e.result()}var i,e,o=4.5;return r.area=function(n){return v(n,i(xt)),xt.result()},r.measure=function(n){return v(n,i(Bt)),Bt.result()},r.bounds=function(n){return v(n,i(jt)),jt.result()},r.centroid=function(n){return v(n,i(Gt)),Gt.result()},r.projection=function(t){return arguments.length?(i=null==t?(n=null,J):(n=t).stream,r):n},r.context=function(n){return arguments.length?(e=null==n?(t=null,new sn):new fn(t=n),"function"!=typeof o&&e.pointRadius(o),r):t},r.pointRadius=function(n){return arguments.length?(o="function"==typeof n?n:(e.pointRadius(+n),+n),r):o},r.projection(n).context(t)}function vn(n){return function(t){var r=new gn;for(var i in n)r[i]=n[i];return r.stream=t,r}}function gn(){}function dn(n,t,r){var i=n.clipExtent&&n.clipExtent();return n.scale(150).translate([0,0]),null!=i&&n.clipExtent(null),v(r,n.stream(jt)),t(jt.result()),null!=i&&n.clipExtent(i),n}function yn(n,t,r){return dn(n,function(r){var i=t[1][0]-t[0][0],e=t[1][1]-t[0][1],o=Math.min(i/(r[1][0]-r[0][0]),e/(r[1][1]-r[0][1])),u=+t[0][0]+(i-o*(r[1][0]+r[0][0]))/2,a=+t[0][1]+(e-o*(r[1][1]+r[0][1]))/2;n.scale(150*o).translate([u,a])},r)}function mn(n,t,r){return yn(n,[[0,0],t],r)}function Sn(n,t,r){return dn(n,function(r){var i=+t,e=i/(r[1][0]-r[0][0]),o=(i-e*(r[1][0]+r[0][0]))/2,u=-e*r[0][1];n.scale(150*e).translate([o,u])},r)}function En(n,t,r){return dn(n,function(r){var i=+t,e=i/(r[1][1]-r[0][1]),o=-e*r[0][0],u=(i-e*(r[1][1]+r[0][1]))/2;n.scale(150*e).translate([o,u])},r)}function _n(n,t){return+t?xn(n,t):Mn(n)}function Mn(n){return vn({point:function(t,r){t=n(t,r),this.stream.point(t[0],t[1])}})}function xn(n,t){function r(i,e,o,u,a,f,l,s,p,h,v,g,d,y){var m=l-i,S=s-e,E=m*m+S*S;if(E>4*t&&d--){var _=u+h,M=a+v,x=f+g,b=ut(_*_+M*M+x*x),w=c(x/=b),N=nt(nt(x)-1)<Kn||nt(o-p)<Kn?(o+p)/2:rt(M,_),P=n(N,w),j=P[0],k=P[1],A=j-i,F=k-e,q=S*A-m*F;(q*q/E>t||nt((m*A+S*F)/E-.5)>.3||u*h+a*v+f*g<Kt)&&(r(i,e,o,u,a,f,j,k,N,_/=b,M/=b,x,d,y),y.point(j,k),r(j,k,N,_,M,x,l,s,p,h,v,g,d,y))}}return function(t){function i(r,i){r=n(r,i),t.point(r[0],r[1])}function e(){m=NaN,x.point=o,t.lineStart()}function o(i,e){var o=d([i,e]),u=n(i,e);r(m,S,y,E,_,M,m=u[0],S=u[1],y=i,E=o[0],_=o[1],M=o[2],Jt,t),t.point(m,S)}function u(){x.point=i,t.lineEnd()}function a(){e(),x.point=f,x.lineEnd=c}function f(n,t){o(l=n,t),s=m,p=S,h=E,v=_,g=M,x.point=o}function c(){r(m,S,y,E,_,M,s,p,l,h,v,g,Jt,t),x.lineEnd=u,u()}var l,s,p,h,v,g,y,m,S,E,_,M,x={point:i,lineStart:e,lineEnd:u,polygonStart:function(){t.polygonStart(),x.lineStart=a},polygonEnd:function(){t.polygonEnd(),x.lineStart=e}};return x}}function bn(n){return vn({point:function(t,r){var i=n(t,r);return this.stream.point(i[0],i[1])}})}function wn(n){function t(n){return n=l(n[0]*$n,n[1]*$n),[n[0]*d+a,f-n[1]*d]}function r(n){return(n=l.invert((n[0]-a)/d,(f-n[1])/d))&&[n[0]*Yn,n[1]*Yn]}function i(n,t){return n=u(n,t),[n[0]*d+a,f-n[1]*d]}function e(){l=x(c=w(_,M,b),u);var n=u(S,E);return a=y-n[0]*d,f=m+n[1]*d,o()}function o(){return v=g=null,t}var u,a,f,c,l,s,p,h,v,g,d=150,y=480,m=250,S=0,E=0,_=0,M=0,b=0,N=null,P=mt,j=null,k=J,A=.5,F=_n(i,A);return t.stream=function(n){return v&&g===n?v:v=Qt(bn(c)(P(F(k(g=n)))))},t.preclip=function(n){return arguments.length?(P=n,N=void 0,o()):P},t.postclip=function(n){return arguments.length?(k=n,j=s=p=h=null,o()):k},t.clipAngle=function(n){return arguments.length?(P=+n?W(N=n*$n):(N=null,mt),o()):N*Yn},t.clipExtent=function(n){return arguments.length?(k=null==n?(j=s=p=h=null,J):B(j=+n[0][0],s=+n[0][1],p=+n[1][0],h=+n[1][1]),o()):null==j?null:[[j,s],[p,h]]},t.scale=function(n){return arguments.length?(d=+n,e()):d},t.translate=function(n){return arguments.length?(y=+n[0],m=+n[1],e()):[y,m]},t.center=function(n){return arguments.length?(S=n[0]%360*$n,E=n[1]%360*$n,e()):[S*Yn,E*Yn]},t.rotate=function(n){return arguments.length?(_=n[0]%360*$n,M=n[1]%360*$n,b=n.length>2?n[2]%360*$n:0,e()):[_*Yn,M*Yn,b*Yn]},t.precision=function(n){return arguments.length?(F=_n(i,A=n*n),o()):ut(A)},t.fitExtent=function(n,r){return yn(t,n,r)},t.fitSize=function(n,r){return mn(t,n,r)},t.fitWidth=function(n,r){return Sn(t,n,r)},t.fitHeight=function(n,r){return En(t,n,r)},function(){return u=n.apply(this,arguments),t.invert=u.invert&&r,e()}}function Nn(n){var t=0,r=Qn/3,i=wn(n),e=i(t,r);return e.parallels=function(n){return arguments.length?i(t=n[0]*$n,r=n[1]*$n):[t*Yn,r*Yn]},e}function Pn(n){function t(n,t){return[n*r,et(t)/r]}var r=it(n);return t.invert=function(n,t){return[n/r,c(t*r)]},t}function jn(n,t){function r(n,t){var r=ut(o-2*e*et(t))/e;return[r*et(n*=e),u-r*it(n)]}var i=et(n),e=(i+et(t))/2;if(nt(e)<Kn)return Pn(n);var o=1+i*(2*e-i),u=ut(o)/e;return r.invert=function(n,t){var r=u-t;return[rt(n,nt(r))/e*ot(r),c((o-(n*n+r*r)*e*e)/(2*e))]},r}function kn(){return Nn(jn).scale(155.424).center([0,33.6442])}function An(){return kn().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Fn(n){return n}function qn(n){if(null==n)return Fn;var t,r,i=n.scale[0],e=n.scale[1],o=n.translate[0],u=n.translate[1];return function(n,a){a||(t=r=0);var f=2,c=n.length,l=new Array(c);for(l[0]=(t+=n[0])*i+o,l[1]=(r+=n[1])*e+u;f<c;)l[f]=n[f],++f;return l}}function On(n,t){for(var r,i=n.length,e=i-t;e<--i;)r=n[e],n[e++]=n[i],n[i]=r}function zn(n,t){return"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return Cn(n,t)})}:Cn(n,t)}function Cn(n,t){var r=t.id,i=t.bbox,e=null==t.properties?{}:t.properties,o=Ln(n,t);return null==r&&null==i?{type:"Feature",properties:e,geometry:o}:null==i?{type:"Feature",id:r,properties:e,geometry:o}:{type:"Feature",id:r,bbox:i,properties:e,geometry:o}}function Ln(n,t){function r(n,t){t.length&&t.pop();for(var r=c[n<0?~n:n],i=0,e=r.length;i<e;++i)t.push(f(r[i],i));n<0&&On(t,e)}function i(n){return f(n)}function e(n){for(var t=[],i=0,e=n.length;i<e;++i)r(n[i],t);return t.length<2&&t.push(t[0]),t}function o(n){for(var t=e(n);t.length<4;)t.push(t[0]);return t}function u(n){return n.map(o)}function a(n){var t,r=n.type;switch(r){case"GeometryCollection":return{type:r,geometries:n.geometries.map(a)};case"Point":t=i(n.coordinates);break;case"MultiPoint":t=n.coordinates.map(i);break;case"LineString":t=e(n.arcs);break;case"MultiLineString":t=n.arcs.map(e);break;case"Polygon":t=u(n.arcs);break;case"MultiPolygon":t=n.arcs.map(u);break;default:return null}return{type:r,coordinates:t}}var f=qn(n.transform),c=n.arcs;return a(t)}function Rn(){function n(n,o){n=i(n);for(var a,f,v,g,d,y=h(n.transform),m=n.arcs.length,S=0,E=new Array(m);S<m;){for(a=0,f=0,v=n.arcs[S].length,g=0,d=new Array(v);g<v;)n.arcs[S][g][0]=a+=n.arcs[S][g][0],n.arcs[S][g][1]=f+=n.arcs[S][g][1],d[g]=null===l?y(n.arcs[S][g]):l(y(n.arcs[S][g])),g++;E[S++]=d}var _=hn().projection(null),M=u(E,{type:"GeometryCollection",geometries:o}).geometries.map(function(t){return{type:"Feature",id:t.id,properties:s.call(null,t,n),geometry:t}}),x=M.map(p),b=e(x);if(c<=0)return M;for(var w=0;w++<c;){for(var v,g,N,N,P,j,k,A,F,q,O,z,C,L,R,G=M.map(_.area),T=e(G),D=0,I=0,H=M.map(function(n,t){var r=Math.abs(G[t]),i=+x[t],e=T*i/b,o=Math.sqrt(r/Math.PI),u=Math.sqrt(e/Math.PI)-o,a=Math.max(r,e)/Math.min(r,e);return D+=a,I++,{id:n.id,area:r,centroid:_.centroid(n),value:i,desired:e,radius:o,mass:u,sizeError:a}}),W=D/I,Z=1/(1+W),m=E.length,S=0;S<m;){for(v=E[S].length,g=0;g<v;){for(N=[0,0],P=H.length,j=0;j<P;)k=H[j].centroid,A=H[j].mass,F=H[j].radius,q=F*F,O=E[S][g][0]-k[0],z=E[S][g][1]-k[1],C=O*O+z*z,L=Math.sqrt(C),R=L>F?A*F/L:A*(C/q)*(4-3*L/F),N[0]+=R*t(z,O),N[1]+=R*r(z,O),j++;E[S][g][0]+=N[0]*Z,E[S][g][1]+=N[1]*Z,g++}S++}if(W<=1)break}return{features:M,arcs:E}}function t(n,t){if(0===t)return 0;var r=n/t;return t>0?1/Math.sqrt(1+r*r):-1/Math.sqrt(1+r*r)}function r(n,t){if(0===t)return 1;var r=n/t;return t>0?r/Math.sqrt(1+r*r):-r/Math.sqrt(1+r*r)}function i(n){return n instanceof Array?n.map(i):"string"==typeof n||"number"==typeof n?n:o(n)}function o(n){var t={};for(var r in n)t[r]=i(n[r]);return t}function u(n,t){function r(t,r){r.length&&r.pop();for(var i=n[t<0?~t:t],e=0,o=i.length;e<o;++e)r.push(i[e]);t<0&&a(r,o)}function i(n){for(var t=[],i=0,e=n.length;i<e;++i)r(n[i],t);return t}function e(n){return n.map(i)}function o(n){return n=Object.create(n),n.coordinates=u[n.type](n.arcs),n}var u={LineString:i,MultiLineString:e,Polygon:e,MultiPolygon:function(n){return n.map(e)}};return"GeometryCollection"===t.type?(t=Object.create(t),t.geometries=t.geometries.map(o),t):o(t)}function a(n,t){for(var r,i=n.length,e=i-t;e<--i;)r=n[e],n[e++]=n[i],n[i]=r}function f(n){return function(){return n}}var c=8,l=An(),s=function(n){return{}},p=function(n){return 1};n.path=hn().projection(null),n.iterations=function(t){return arguments.length?(c=t,n):c},n.value=function(t){return arguments.length?(p="function"==typeof t?t:f(t),n):p},n.projection=function(t){return arguments.length?(l=t,n):l},n.feature=function(n,t){return{type:"Feature",id:t.id,properties:s.call(null,t,n),geometry:{type:t.type,coordinates:zn(n,t).geometry.coordinates}}},n.features=function(t,r){return r.map(function(r){return n.feature(t,r)})},n.properties=function(t){return arguments.length?(s="function"==typeof t?t:f(t),n):s};var h=n.transformer=function(n){function t(n){return[n[0]*r+e,n[1]*i+o]}var r=n.scale[0],i=n.scale[1],e=n.translate[0],o=n.translate[1];return t.invert=function(n){return[(n[0]-e)/r,(n[1]-o)/i]},t};return n}!function(n){1===n.length&&(n=r(n))}(t);u.prototype={constructor:u,reset:function(){this.s=this.t=0},add:function(n){a(Jn,n,this.t),a(this,Jn.s,this.s),this.s?this.t+=Jn.t:this.s=Jn.t},valueOf:function(){return this.s}};var Gn,Tn,Dn,In,Hn,Wn,Zn,Bn,Jn=new u,Kn=1e-6,Qn=Math.PI,Un=Qn/2,Vn=Qn/4,Xn=2*Qn,Yn=180/Qn,$n=Qn/180,nt=Math.abs,tt=Math.atan,rt=Math.atan2,it=Math.cos,et=Math.sin,ot=Math.sign||function(n){return n>0?1:n<0?-1:0},ut=Math.sqrt,at={Feature:function(n,t){s(n.geometry,t)},FeatureCollection:function(n,t){for(var r=n.features,i=-1,e=r.length;++i<e;)s(r[i].geometry,t)}},ft={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var r=n.coordinates,i=-1,e=r.length;++i<e;)n=r[i],t.point(n[0],n[1],n[2])},LineString:function(n,t){p(n.coordinates,t,0)},MultiLineString:function(n,t){for(var r=n.coordinates,i=-1,e=r.length;++i<e;)p(r[i],t,0)},Polygon:function(n,t){h(n.coordinates,t)},MultiPolygon:function(n,t){for(var r=n.coordinates,i=-1,e=r.length;++i<e;)h(r[i],t)},GeometryCollection:function(n,t){for(var r=n.geometries,i=-1,e=r.length;++i<e;)s(r[i],t)}};o(),o(),o();b.invert=b;var ct,lt,st,pt,ht,vt,gt,dt,yt=o(),mt=R(function(){return!0},D,H,[-Qn,-Un]),St=1e9,Et=-St,_t=(o(),o()),Mt=o(),xt={point:l,lineStart:l,lineEnd:l,polygonStart:function(){xt.lineStart=K,xt.lineEnd=V},polygonEnd:function(){xt.lineStart=xt.lineEnd=xt.point=l,_t.add(nt(Mt)),Mt.reset()},result:function(){var n=_t/2;return _t.reset(),n}},bt=1/0,wt=bt,Nt=-bt,Pt=Nt,jt={point:X,lineStart:l,lineEnd:l,polygonStart:l,polygonEnd:l,result:function(){var n=[[bt,wt],[Nt,Pt]];return Nt=Pt=-(wt=bt=1/0),n}},kt=0,At=0,Ft=0,qt=0,Ot=0,zt=0,Ct=0,Lt=0,Rt=0,Gt={point:Y,lineStart:$,lineEnd:rn,polygonStart:function(){Gt.lineStart=en,Gt.lineEnd=on},polygonEnd:function(){Gt.point=Y,Gt.lineStart=$,Gt.lineEnd=rn},result:function(){var n=Rt?[Ct/Rt,Lt/Rt]:zt?[qt/zt,Ot/zt]:Ft?[kt/Ft,At/Ft]:[NaN,NaN];return kt=At=Ft=qt=Ot=zt=Ct=Lt=Rt=0,n}};fn.prototype={_radius:4.5,pointRadius:function(n){return this._radius=n,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(n,t){switch(this._point){case 0:this._context.moveTo(n,t),this._point=1;break;case 1:this._context.lineTo(n,t);break;default:this._context.moveTo(n+this._radius,t),this._context.arc(n,t,this._radius,0,Xn)}},result:l};var Tt,Dt,It,Ht,Wt,Zt=o(),Bt={point:l,lineStart:function(){Bt.point=cn},lineEnd:function(){Tt&&ln(Dt,It),Bt.point=l},polygonStart:function(){Tt=!0},polygonEnd:function(){Tt=null},result:function(){var n=+Zt;return Zt.reset(),n}};sn.prototype={_radius:4.5,_circle:pn(4.5),pointRadius:function(n){return(n=+n)!==this._radius&&(this._radius=n,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(n,t){switch(this._point){case 0:this._string.push("M",n,",",t),this._point=1;break;case 1:this._string.push("L",n,",",t);break;default:null==this._circle&&(this._circle=pn(this._radius)),this._string.push("M",n,",",t,this._circle)}},result:function(){if(this._string.length){var n=this._string.join("");return this._string=[],n}return null}},gn.prototype={constructor:gn,point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Jt=16,Kt=it(30*$n),Qt=vn({point:function(n,t){this.stream.point(n*$n,t*$n)}});"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self,function(n,t){t={exports:{}},n(t,t.exports),t.exports}(function(n,t){!function(t,r,i){n.exports=function(){function n(n,t,r){return n instanceof Array?(n.push(r),n[n.length-1]):n instanceof Object?(n[t]=r,n[t]):void 0}return function(t){function r(t,i){for(var e in t){var o=t[e];if(o instanceof Date){var u=new Date(o.getTime());n(i,e,u)}else if(o instanceof Function){var u=o;n(i,e,u)}else if(o instanceof Array){var u=[],a=n(i,e,u);r(o,a)}else if(o instanceof Object){var u={},a=n(i,e,u);r(o,a)}else{var u=o;n(i,e,u)}}}if(/number|string|boolean/.test(typeof t))return t;if(t instanceof Date)return new Date(t.getTime());var i=t instanceof Array?[]:{};return r(t,i),i}}()}()});n.cartogram=Rn,Object.defineProperty(n,"__esModule",{value:!0})});